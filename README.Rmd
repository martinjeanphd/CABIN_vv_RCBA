---
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '4'
  html_notebook:
    number_sections: yes
    toc: yes
    toc_depth: 4
    toc_float: yes
  word_document: default
---


![](Configuration/gc_en.png) &nbsp;&nbsp; ![](Configuration/cabin_logo.png)

# VERIFICATION AND VALIDATION OF CABIN DATA

*[Martin Jean](mailto:martin.jean@canada.ca) and Évelyne Paquette-Boisclair*

*Environment and Climate change Canada*

## Why This Tool?

This tool offers you a reproducible approach in the evaluation of the quality of your CABIN data. It allows you to import your CABIN data (from the CABIN database or from your own files) into the *R* format. It then helps you verify and validate your data successively in order to detect problems, irregularities or potential aberrations. It applies to all of your data, be it general, biological, and habitat (environmental).

Finally, a summary analysis of some statistical characteristics of your data is presented to you, thus allowing you to know your data better and take advantage of the protocol of statistical analysis provided for in  CABIN.

## Tool Structure

The tool is composed of five R Markdown notebooks corresponding to the import of your data and then the examination of general, biological, environmental (habitat) data, and geographical coordinates.

Each notebook contains text describing the steps and suggestions for action on the results obtained. There is also the code to execute the *R* commands as well as the result of this code. All this information can be saved and viewed in interactive HTML format or saved in *Microsoft Word* format.

## Requirements

To use these tools, you must have the following:

- a computer running *Windows*, *macOS*, or *Linux*;
- the *R* language version 2.11.1 or later, available [here](http://cran.r-project.org);
- the application *RStudio* version 1.0 or later, available [here](http://www.rstudio.com);
- an advanced text editor is recommended (for example, *[Notepad ++](http://notepad-plus-plus.org)* under *Windows*, *[BBEdit](http://www.barebones.com/products/bbedit /)* under *macOS*, or *[Geany](http://www.geany.org)* under *Linux*);
- an Internet connection;
- Access to the folder *CABIN_vv_RCBA*. This folder is available on the shared workspace on the ECCC internal network (accessible at \\\ec_ontario\\afs\\GroupShares\\Bur\\GS2\\CABIN\\CABIN QA-QC\\R Tool\\CABIN_vv_RCBA).

## Instructions for Starting an Analysis

First, you need to install the packages needed by *R* for running this READ ME file.

```{r setup, include=FALSE}
## Required parckage
library(svDialogs)

```

To perform an analysis of the quality of your CABIN data, you must do the following:

- Export your data from the CABIN database or prepare your data files using the provided templates;
- Launch *RStudio*;
- Open document *README.Rmd*, read the contents, name your project and run the code to create a folder structure for your project (see below);
- Place your data files in the *Data_Donnees* folder located in your newly created project folder;
- Create a project in *RStudio* and assign it to your newly created project folder;
- Import your data using the *CABIN_vv_import.Rmd* notebook;
- Analyze your general data using the *CABIN_vv_general.Rmd* notebook;
- Analyze your geographic data using the *CABIN_vv_spatial.Rmd* notebook;
- Analyze your biological data using the *CABIN_vv_biological.Rmd* notebook;
- Finally, analyze your environmental data using the *CABIN_vv_habitat.Rmd* notebook.

## Structure and description of the CABIN_vv_RCBA Folder

###General Folder Structure

The following diagram illustrates the overall structure of the files contained in the *CABIN_vv_RCBA* folder:

```
CABIN_vv_RCBA
|_
   Configuration
      
|_
   Functions_Fonctions
    
|_
   LISEZMOI.Rmd
    
|_
   Projects_Projets
    
|_
   README.Rmd
    
|_
   Requirements.R
    
|_
   Templates_Modèles
```

All the folders and files contained in this structure are essential. You will have to modify the contents of the folder * Projects_Projects * according to your needs.

### Folders and Files Description

The following is a brief description of the various files and folders contained in the *CABIN_vv_RCBA* folder.

**Configuration** : folder containing general settings on the *R* environment, the file containing the list of variables, and the images used in the various notebooks.

**Functions_Fonctions** : folder containing a set of files that contain custom procedures and functions. 

**LISEZMOI.Rmd** : the French version of the file you're reading now.

**Projects_Projets** : folder containing the various projects. A project may correspond to a particular analysis of your data.

**README.Rmd** : the file your are reading now.

**Requirements.R** : file containing commands for installing *R* packages and calls to custom function files.

**Templates_Modèles** : folder containing project templates in English and French.

## General Operation

This document is a [R Markdown notebook](http://rmarkdown.rstudio.com). When you execute the code present in such a notebook, the results are displayed under the corresponding code.

To start, replace the word *Test* in the line below with the name you want to give to your project, then press the *Run Current Chunk* button inside the code block (*chunk*), or by placing the cursor inside the chunk and typing *Cmd+Shift+Enter*.

```{r include=FALSE}
# Run the chunk
folderName <- "Test"
folderName <- svDialogs::dlgInput("Project folder name to create:", default = "Test", Sys.info()["folderName"])$res
if(is.null(folderName) | length(folderName) == 0) {folderName = "Test"} else {if(folderName == "NA") {folderName <- "Test"}}



from <- "Templates_Modeles/English"
to <- "Projects_Projets/"

file.copy(from, to, recursive = TRUE)
file.rename(paste(to, "English", sep = ""), paste(to, folderName, sep = ""))

myProject <- function(proj, ...) {

 
    x <- c("Version: 1.0", "", "RestoreWorkspace: Default", "SaveWorkspace: Default", 
        "AlwaysSaveHistory: Default", "", "EnableCodeIndexing: Yes", 
        "UseSpacesForTab: Yes", "NumSpacesForTab: 4", "Encoding: UTF-8", 
        "", "RnwWeave: knitr", "LaTeX: pdfLaTeX")

    cat(paste(x, collapse="\n"), file=file.path(proj, paste0(basename(proj), ".Rproj")))

    message(paste(basename(proj), "a été créé"))
    svDialogs::dlg_message(paste(nomDossier, " a été créé."), type = c("ok"))
}

myProject(paste(to, nomDossier, sep = ""))
```


By saving a R Markdown R notebook, an HTML file containing the code and the results will be created in the same folder as the notebook (press the *Preview* button or the *Cmd+Shift+K* keys to preview the HTML file).

## References

Besides the numerous resources from the Web, the following references guided this product:

- Borcard, D., Gillet, F. et Legendre, P. (2011). Numerical Ecology with R. New York: Springer. Info at http://www.springer.com/us/book/9781441979759

- Roberts, D. R Labs for Community Ecologists. Consulted on 2016-07-14, at http://ecology.msu.montana.edu/labdsv/R/

- Zuur, A. F., Ieno, E. N. et Elphick, C. S. (2010 Mar 01). A protocol for data exploration to avoid common statistical problems. Methods in Ecology and Evolution, 1(1), 3-14. http://dx.doi.org/10.1111/j.2041-210X.2009.00001.x

